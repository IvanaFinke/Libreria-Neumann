@page "/iniciar-sesion"
@inject IJSRuntime JS
@rendermode InteractiveServer


<div class="inicio-sesion">
    <h1 class="inisesi-titulo">Iniciar Sesión</h1>
    <div class="ingresos">
        <i class="bi bi-person-circle"></i>
        <div class="ingreso-mail">
            <h4>Ingrese su mail</h4>
                <input type="email" class="ingreso" />
        </div>

        <div class="ingreso-contraseña">
            <h4>Ingrese su constraseña</h4>
            <input type="password" class="ingreso" /> 
            <NavLink class="nav-link-contraseña">
                <span class="olvidaste-contraseña"><strong>¿Olvidaste tu contraseña?</strong></span>
            </NavLink>
        </div>

        <div class="clase-captcha">
            <div class="g-recaptcha"></div>
        </div>


        <div class="boton-preguntar-registrar">
            <button class="boton-inicio-sesion" @onclick="IniciarSesion">Iniciar Sesión</button>
      
            <div class="preguntar-registrar">
                <h5 class="preguntar-cuenta">¿No tenés cuenta?</h5>
                <NavLink class="nav-link-registrarme">
                    <span class="frase-registrarme">Registrarme</span>
                </NavLink>
            </div>
        </div>
    </div>

</div>

@code {
    [Inject] ReCaptcha Captcha{ get; set; }

    async Task IniciarSesion()
    {
        var token = await JS.InvokeAsync<string>("getCaptchaToken");

        var validate = await Captcha.Validate(token);

        if (!validate)
        {
            Console.WriteLine("Captcha no válido");
            return;
        }
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if(firstRender)
        {
            await JS.InvokeVoidAsync("renderCaptcha");
        }
    }

}
